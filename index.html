<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">

<style>
    :root {
        /* CORES */
        --capa-base: #151515; /* Fundo escuro */
        --prata: #e0e0e0; /* Prata claro para ornamentos */
        --papel: #fdf6e3; /* Cor de papel envelhecido */
        --fita: #8b0000; /* Vermelho escuro para a fita */
        
        /* ASSETS EXTERNOS */
        --leather-tex: url('https://www.transparenttextures.com/patterns/dark-leather.png');
        --corner-url: url('https://i.imgur.com/eKnNgYK.png');
    }

    body {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        background: transparent; /* Fundo transparente para o Notion */
        font-family: 'Georgia', serif;
        overflow: hidden;
    }

    .viewport {
        width: 450px; /* Largura aumentada para acomodar a rotação do livro grosso */
        height: 450px;
        perspective: 1500px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .book {
        width: 260px;
        height: 360px;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        transform: rotateY(-20deg); /* Ângulo inicial fechado */
    }

    .book.open {
        transform: rotateY(0deg) translateX(55px); /* Posição quando aberto */
    }

    /* --- LOMBADA --- */
    .spine {
        position: absolute;
        left: -24px; top: 0;
        width: 26px; /* Espessura da lombada */
        height: 100%;
        background: var(--capa-base);
        background-image: var(--leather-tex);
        transform: rotateY(-90deg);
        transform-origin: right;
        box-shadow: inset -5px 0 10px rgba(0,0,0,0.5);
    }

    /* --- CONTRACAPA (FUNDO DO LIVRO) --- */
    .book-back {
        position: absolute;
        width: 104.5%; /* Ligeiramente mais largo para a borda */
        height: 100%;
        background: var(--capa-base);
        background-image: var(--leather-tex);
        border-radius: 0 5px 5px 0;
        transform: translateZ(-10px); 
    }

    /* --- CAPA FRONTAL --- */
    .cover {
        position: absolute;
        width: 100%; height: 100%;
        background-color: var(--capa-base);
        border-radius: 0 5px 5px 0;
        z-index: 100;
        transform-origin: left;
        transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        transform-style: preserve-3d;
        /* CORREÇÃO DO BUG: Aumento do delay ao fechar para 0.9s.
           Isso garante que a capa só feche depois que todas as páginas pararam de se mover. */
        transition-delay: 0.8s; 
    }

    .book.open .cover {
        transform: rotateY(-155deg); /* Ângulo de abertura */
        /* Ao abrir, o delay é zero para ser imediato */
        transition-delay: 0s; 
    }

    /* --- ARTE DA CAPA --- */
    .front-face-art {
        position: absolute;
        top:0; left:0; width: 100%; height: 100%;
        /* Gradiente para dar profundidade ao couro */
        background-color: var(--capa-base);
        background-image: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(0,0,0,0.4) 100%), var(--leather-tex);
        border-radius: 0 5px 5px 0;
        display: flex;
        justify-content: center;
        align-items: flex-start; /* Alinha o conteúdo ao topo */
        backface-visibility: hidden;
        z-index: 2;
        box-shadow: inset 1px 1px 2px rgba(255,255,255,0.1), inset -2px -2px 5px rgba(0,0,0,0.5);
    }

    /* Vinco lateral da capa */
    .spine-groove {
        position: absolute;
        left: 15px; top: 0; bottom: 0; width: 4px;
        border-left: 1px solid rgba(0,0,0,0.6);
        border-right: 1px solid rgba(255,255,255,0.1);
        background: rgba(0,0,0,0.2);
    }

    /* --- CANTONEIRAS --- */
    .corner-ornament {
        position: absolute;
        width: 70px; 
        height: 70px;
        background-image: var(--corner-url);
        background-size: contain;
        background-repeat: no-repeat;
        pointer-events: none;
        z-index: 10;
        /* Filtro para dar brilho prateado e sombra */
        filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.8)) brightness(1.2);
    }
    /* Topo Direito */
    .co-tr {
        top: -1px; 
        right: -1px;
        transform: rotate(90deg); 
    }
    /* Baixo Direito (Invertida) */
    .co-br {
        bottom: -1px; 
        right: -1px;
        transform: rotate(90deg) scaleX(-1); 
    }

    /* --- CONTEÚDO DO TÍTULO --- */
    .cover-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 70%;
        margin-left: 15px;
        margin-top: 50px; /* Controla a altura do título */
    }

    .front-face-art h1 {
        font-family: 'UnifrakturMaguntia', cursive;
        color: var(--prata);
        font-size: 1.7rem;
        text-align: center;
        font-weight: normal;
        margin: 15px 0;
        line-height: 1.1;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.9);
    }

    /* Divisores (Imagem externa) */
    .divider {
        width: 160px; height: 20px;
        background-image: url('https://i.imgur.com/F0LHG3G.png');
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        filter: brightness(1.2) grayscale(1); /* Ajuste de cor para prata */
        opacity: 0.9;
    }
    .divider-bottom {
        transform: scaleY(-1); /* Inverte o de baixo */
        margin-top: -5px;
    }
    .divider-top {
        margin-bottom: -5px;
    }

    /* --- PÁGINAS ANIMADAS (As 6 folhas) --- */
    .turning-page {
        position: absolute;
        width: 250px; height: 350px;
        top: 5px; left: 5px;
        background: var(--papel);
        transform-origin: left;
        /* Curva de animação suave e longa */
        transition: transform 1.2s cubic-bezier(0.15, 0, 0.15, 1);
        border-radius: 0 4px 4px 0;
        transform-style: preserve-3d; /* Importante para evitar bugs visuais */
    }

    /* Delays e Z-Index para o fechamento (Ordem inversa) */
    .p1 { transition-delay: 0.6s; z-index: 40; }
    .p2 { transition-delay: 0.5s; z-index: 39; }
    .p3 { transition-delay: 0.4s; z-index: 38; }
    .p4 { transition-delay: 0.3s; z-index: 37; }
    .p5 { transition-delay: 0.2s; z-index: 36; }
    .p6 { transition-delay: 0.1s; z-index: 35; }

    /* Configuração ao ABRIR (Delays em cascata e ângulos) */
    .book.open .p1 { transform: rotateY(-150deg); transition-delay: 0.1s; }
    .book.open .p2 { transform: rotateY(-147deg); transition-delay: 0.2s; }
    .book.open .p3 { transform: rotateY(-144deg); transition-delay: 0.3s; }
    .book.open .p4 { transform: rotateY(-141deg); transition-delay: 0.4s; }
    .book.open .p5 { transform: rotateY(-138deg); transition-delay: 0.5s; }
    .book.open .p6 { transform: rotateY(-135deg); transition-delay: 0.6s; }

    /* --- BLOCO DE PÁGINAS FIXO (Lado Direito) --- */
    .right-stack {
        position: absolute;
        width: 250px; height: 350px;
        top: 5px; left: 5px;
        background: var(--papel);
        border-radius: 0 4px 4px 0;
        z-index: 10;
        display: flex; flex-direction: column;
        justify-content: center; align-items: center;
        padding: 30px 25px 30px 45px;
        box-sizing: border-box;
        text-align: center;
        /* Efeito de volume com sombras alternadas */
        box-shadow: 
            1px 0 0 #d1c9b8, 2px 0 0 #fdf6e3, 
            3px 0 0 #d1c9b8, 4px 0 0 #fdf6e3,
            5px 0 0 #d1c9b8, 6px 0 0 #fdf6e3, 
            7px 0 0 #d1c9b8, 8px 0 0 #fdf6e3,
            9px 0 0 #d1c9b8, 10px 0 0 #fdf6e3, 
            11px 0 0 #d1c9b8, 12px 0 15px rgba(0,0,0,0.3);
    }

    /* --- FITA DE MARCAÇÃO --- */
    .ribbon-container {
        position: absolute;
        top: 4px; left: 15px;
        width: 14px; height: 380px; 
        overflow: hidden;
        z-index: 60;
        pointer-events: none;
    }
    .ribbon {
        position: absolute; top: -380px; left: 0;
        width: 100%; height: 100%;
        background: var(--fita);
        box-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        transition: top 0.6s ease, height 0.2s ease;
        pointer-events: auto; cursor: grab;
        /* Recorte da ponta da fita em V sutil */
        clip-path: polygon(0 0, 100% 0, 100% 100%, 50% 97%, 0 100%);
    }
    .book.open .ribbon { top: 0; }
    .ribbon.pulling { cursor: grabbing; transition: none; }

    /* Estilos do texto interno */
    #obra-titulo { font-weight: bold; font-size: 1.1rem; margin-bottom: 8px; color: #111; }
    #obra-sinopse { font-size: 0.85rem; color: #444; font-style: italic; line-height: 1.4; }
    #obra-link { margin-top: 15px; color: var(--fita); text-decoration: none; font-weight: bold; border-bottom: 1px solid; font-size: 0.85rem; display: inline-block; cursor: pointer;}
</style>
</head>
<body>

<div class="viewport">
    <div class="book" id="book">
        <div class="spine"></div>
        <div class="book-back"></div>

        <div class="cover" onclick="toggleBook()">
            <div class="front-face-art">
                <div class="spine-groove"></div>
                <div class="corner-ornament co-tr"></div>
                <div class="corner-ornament co-br"></div>
                
                <div class="cover-content">
                    <div class="divider divider-top"></div>
                    <h1>Mana i entulë<br>nómë?</h1>
                    <div class="divider divider-bottom"></div>
                </div>
            </div>
        </div>

        <div class="turning-page p1" onclick="closeBook()"></div>
        <div class="turning-page p2" onclick="closeBook()"></div>
        <div class="turning-page p3" onclick="closeBook()"></div>
        <div class="turning-page p4" onclick="closeBook()"></div>
        <div class="turning-page p5" onclick="closeBook()"></div>
        <div class="turning-page p6" onclick="closeBook()"></div>

        <div class="right-stack">
            <div id="obra-titulo"></div>
            <div id="obra-sinopse"></div>
            <a id="obra-link" target="_blank">Ler Obra →</a>
        </div>

        <div class="ribbon-container">
            <div class="ribbon" id="ribbon"></div>
        </div>
    </div>
</div>

<script>
    const obras = [
        { titulo: "Dom Casmurro", sinopse: "A dúvida sobre a traição de Capitu narrada por um Bentinho mergulhado no ciúme.", link: "https://www.notion.so/Backups-2e4d0c17411c80e08bb3dc587b82d17f" },
        { titulo: "O Alienista", sinopse: "Uma sátira genial sobre a loucura e os limites da ciência em uma pequena cidade.", link: "https://www.notion.so/Backups-2e4d0c17411c80e08bb3dc587b82d17f" },
        { titulo: "Memórias Póstumas", sinopse: "Um defunto autor conta sua vida com ironia, começando pelo seu próprio fim.", link: "https://www.notion.so/Backups-2e4d0c17411c80e08bb3dc587b82d17f" },
        { titulo: "Iracema", sinopse: "A lenda da 'virgem dos lábios de mel', um símbolo do encontro entre povos no Brasil.", link: "https://www.notion.so/Backups-2e4d0c17411c80e08bb3dc587b82d17f" }
    ];

    let aberto = false;
    let sorteando = false;
    const book = document.getElementById('book');
    const ribbon = document.getElementById('ribbon');

    function carregarObraAleatoria() {
        const random = obras[Math.floor(Math.random() * obras.length)];
        document.getElementById('obra-titulo').innerText = random.titulo;
        document.getElementById('obra-sinopse').innerText = random.sinopse;
        document.getElementById('obra-link').href = random.link;
    }
    carregarObraAleatoria();

    function toggleBook() {
        if (!aberto) {
            aberto = true;
            book.classList.add('open');
        } else {
            closeBook();
        }
    }

    function closeBook() {
        aberto = false;
        book.classList.remove('open');
    }

    // Lógica da Fita
    let startY = 0;
    let isPulling = false;
    const baseRibbonHeight = 380;

    ribbon.addEventListener('mousedown', startPull);
    document.addEventListener('mousemove', pull);
    document.addEventListener('mouseup', endPull);
    ribbon.addEventListener('touchstart', startPull, {passive: false});
    document.addEventListener('touchmove', pull, {passive: false});
    document.addEventListener('touchend', endPull);

    function startPull(e) {
        if (!aberto || sorteando) return;
        isPulling = true;
        startY = (e.touches ? e.touches[0].clientY : e.clientY);
        ribbon.classList.add('pulling');
    }

    function pull(e) {
        if (!isPulling) return;
        let currentY = (e.touches ? e.touches[0].clientY : e.clientY);
        let deltaY = currentY - startY;
        if (deltaY > 0) {
            let move = Math.min(deltaY, 100);
            ribbon.style.height = `${baseRibbonHeight + move}px`;
            if (deltaY > 70) {
                isPulling = false;
                sortear();
            }
        }
    }

    function endPull() {
        if (isPulling) {
            isPulling = false;
            ribbon.classList.remove('pulling');
            ribbon.style.height = `${baseRibbonHeight}px`;
        }
    }

    function sortear() {
        sorteando = true;
        ribbon.style.height = `${baseRibbonHeight + 40}px`;
        const t = document.getElementById('obra-titulo');
        const s = document.getElementById('obra-sinopse');
        let i = 0;
        const interval = setInterval(() => {
            let random = obras[Math.floor(Math.random() * obras.length)];
            t.innerText = random.titulo;
            s.innerText = random.sinopse;
            i++;
            if (i > 8) {
                clearInterval(interval);
                carregarObraAleatoria();
                sorteando = false;
                ribbon.style.height = `${baseRibbonHeight}px`;
            }
        }, 100);
    }
</script>
</body>
</html>
